#! /bin/bash
# A script using mpv and ffmpeg for the different recordings one might want
# to do

if [ $# -lt 1 ]; then
    echo "please use an option, enter '-h' for help"
elif [ $1 == "-wp" ]; then
    echo "taking a picture"
    mpv tv:// -tv driver=v4l2:width=640:height=480:device=/dev/video0 -fps 15 -vf screenshot
elif [ $1 == "-wv" ]; then
    echo "streaming from webcam"
    mpv tv:// -tv driver=v4l2:width=640:height=480:device=/dev/video0
elif [ $1 == "-sv" ] && [ $# == 3 ]; then
    echo "recording a video of your screen"
    ffmpeg -r 30 -s 1920x1080 -f x11grab -i :0.0 -vcodec mpeg4 -qscale ${2} ${3}.mp4
elif [ $1 == "-ss" ] && [ $# == 2 ]; then
    echo "recording sound"
    ffmpeg -f alsa -ac 2 -i default ${2}.ogg
elif [ $1 == "-sc" ] && [ $# == 3 ]; then
    echo "recording complete screencast"
    ffmpeg -f alsa -ac 2 -i default -itsoffset 00:00:00.5 -f x11grab -r 25 -s 1920x1080 -i :0.0 -vcodec mpeg4 -preset ultrafast -crf 0 -strict experimental -qscale ${2} ${3}.mp4
else
    echo 1>&2 "Usage:
    -wp (take picture from webcam, press s to take the shot)
    -wv (stream webcam to mpv)
    -sv quality filename (take a video of your screen, quality decreasing from 0
        to 10, filename without ending)
    -ss filename (record sound)
    -sc quality filename (complete screencast with sound and video)
    -h (print this help)"
    exit 1
fi
