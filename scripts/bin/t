#!/bin/bash

# A very simple todo list manager

# Make the tasks directory
mkdir -p ~/.cache/tasks
taskfile=~/.cache/tasks/tasks

# Check if an argument was given
if [[ $@ ]]; then

    case "$1" in

    # Finish the tasks given in sed format
    f)  sed -i "$2 d" $taskfile
        ;;
    # Sed substitution to edit the task
    s)  sed -i "$2 s/$3/${*:4}/g" $taskfile
        ;;
    # Change the task completely
    c)  sed -i "$2 s/.*/${*:3} ($(date --iso-8601))/g" $taskfile
        ;;
    # Open taskfile in editor
    e)  $EDITOR $taskfile
        ;;
    # Append the task to the task list
    *)  printf "%s (%s)\n" "$*" "$(date --iso-8601)" >> $taskfile
        ;;
    esac

# If there was no argument simply display the tasks with line numbers
else
    cat -n $taskfile
fi
